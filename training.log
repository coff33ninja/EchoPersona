INFO:root:Output path: trained_models\arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets\arlecchino
INFO:root:Loaded 171 training samples.
INFO:root:Loaded 1 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:>>> Starting Training <<<
ERROR:root:An error occurred during training.
Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1503, in train_epoch
    for cur_step, batch in enumerate(self.train_loader):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\_utils.py", line 721, in reraise
    raise RuntimeError(msg) from None
RuntimeError: Caught UnicodeEncodeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 617, in compute_or_load
    ids = np.load(cache_path)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\numpy\lib\npyio.py", line 427, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models\\arlecchino\\phoneme_cache\\I1ZPIEFybGVjY2hpbm8gQ2xpbWJpbmcgMDE=_phoneme.npy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\characters.py", line 300, in char_to_id
    return self._char_to_id[char]
           ~~~~~~~~~~~~~~~~^^^^^^
KeyError: '\u0361'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 70, in encode
    idx = self.characters.char_to_id(char)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\characters.py", line 302, in char_to_id
    raise KeyError(f" [!] {repr(char)} is not in the vocabulary.") from e
KeyError: " [!] '\u0361' is not in the vocabulary."

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 273, in __getitem__
    token_ids = self.get_token_ids(idx, item["text"])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 240, in get_token_ids
    token_ids = self.get_phonemes(idx, text)["token_ids"]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 217, in get_phonemes
    out_dict = self.phoneme_dataset[idx]
               ~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 602, in __getitem__
    ids = self.compute_or_load(string2filename(item["audio_unique_name"]), item["text"], item["language"])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 619, in compute_or_load
    ids = self.tokenizer.text_to_ids(text, language=language)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 111, in text_to_ids
    text = self.encode(text)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 76, in encode
    print(text)
  File "C:\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u026a' in position 1: character maps to <undefined>


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\Documents\GitHub\EchoPersona\voice_clone_train.py", line 295, in main
    trainer.fit()
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "C:\Users\USER\Documents\GitHub\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:/Users/USER/Documents/GitHub/EchoPersona/trained_models/arlecchino/run-April-14-2025_04+03PM-e0e6e1b\\trainer_0_log.txt'
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:>>> Starting Training <<<
ERROR:root:An error occurred during training.
Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1504, in train_epoch
    outputs, _ = self.train_step(batch, batch_num_steps, cur_step, loader_start_time)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1471, in train_step
    self.update_training_dashboard_logger(batch=batch, outputs=outputs)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\utils\distributed.py", line 35, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1971, in update_training_dashboard_logger
    self.model.train_log(
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1366, in train_log
    figures, audios = self._log(self.ap, batch, outputs, "train")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1336, in _log
    figures = plot_results(y_hat, y, ap, name_prefix)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\vocoder\utils\generic_utils.py", line 48, in plot_results
    y_hat = y_hat[0].squeeze().detach().cpu().numpy()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Got unsupported ScalarType BFloat16

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\voice_clone_train.py", line 295, in main
    trainer.fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'D:/Scripts/EchoPersona/trained_models/Arlecchino/run-April-14-2025_06+31PM-dd0adc8\\trainer_0_log.txt'
INFO:root:Output path: trained_models/Arlecchino
INFO:root:Output path: trained_models\Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets\Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'z', 'D', 'H', '2', 't', 'æ', '\u025b', 'n', '\u026a', 'x', 'k', 'Y', 'U', ':', 'E', '8', 'c', 'y', 'Q', 'p', '\u0251', '7', 'ð', ';', ',', 'f', 'b', 's', 'W', '\u027e', 'K', 'l', '?', '(', 'I', '\u028a', '\u014b', 'T', 'Z', '!', 'g', ' ', '-', 'C', '\u0283', '\u025d', '0', 'u', '\u026b', 'F', 'S', '1', 'V', 'd', '6', 'j', 'P', '\u0292', ')', 'N', '\u0361', "'", 'B', '3', '5', 'w', '9', '"', 'q', '\u028c', '4', 'r', 'v', 'h', 'o', 'A', 'M', 'i', '\u025a', '\u0261', '\u0254', 'J', 'a', 'm', 'e', 'O', 'L', 'X', 'R', '.', '\u0279', 'G'}
INFO:root:>>> Starting Training <<<
ERROR:root:An error occurred during training.
Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1504, in train_epoch
    outputs, _ = self.train_step(batch, batch_num_steps, cur_step, loader_start_time)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1471, in train_step
    self.update_training_dashboard_logger(batch=batch, outputs=outputs)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\utils\distributed.py", line 35, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1971, in update_training_dashboard_logger
    self.model.train_log(
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1366, in train_log
    figures, audios = self._log(self.ap, batch, outputs, "train")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1336, in _log
    figures = plot_results(y_hat, y, ap, name_prefix)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\vocoder\utils\generic_utils.py", line 48, in plot_results
    y_hat = y_hat[0].squeeze().detach().cpu().numpy()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Got unsupported ScalarType BFloat16

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\voice_clone_train.py", line 342, in main
    trainer.fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'D:/Scripts/EchoPersona/trained_models/Arlecchino/run-April-14-2025_10+09PM-6fe7886\\trainer_0_log.txt'
INFO:root:Output path: trained_models\Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets\Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'w', 'I', 'i', 'e', 'W', '6', 'A', 'F', '2', 'X', 'm', '\u0279', '\u0292', '\u025d', 'Q', '\u0283', '0', 'Y', 'G', '\u026a', 'O', 'L', 'v', '\u0251', '\u026b', '\u014b', '-', 'l', 'n', 's', 'H', ';', 'q', '\u027e', '3', 'b', 'K', 'x', '4', 'h', 'B', ')', 'D', 'Z', 'N', "'", 'f', 'æ', '\u0361', '\u0254', 'C', '8', ':', 'T', '1', 'P', 'E', 'z', 'c', '7', '(', 'a', 'S', 'U', '9', 'y', 'ð', '\u025a', 'u', '?', ' ', '"', 'M', ',', 'p', '\u028a', '\u0261', '!', '\u028c', 't', '\u025b', '5', 'j', 'k', 'r', 'V', 'd', 'o', 'R', 'J', 'g', '.'}
INFO:root:>>> Starting Training <<<
ERROR:root:An error occurred during training.
Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1504, in train_epoch
    outputs, _ = self.train_step(batch, batch_num_steps, cur_step, loader_start_time)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1471, in train_step
    self.update_training_dashboard_logger(batch=batch, outputs=outputs)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\utils\distributed.py", line 35, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1971, in update_training_dashboard_logger
    self.model.train_log(
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1366, in train_log
    figures, audios = self._log(self.ap, batch, outputs, "train")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1336, in _log
    figures = plot_results(y_hat, y, ap, name_prefix)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\vocoder\utils\generic_utils.py", line 48, in plot_results
    y_hat = y_hat[0].squeeze().detach().cpu().numpy()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Got unsupported ScalarType BFloat16

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\voice_clone_train.py", line 367, in main
    trainer.fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'D:/Scripts/EchoPersona/trained_models/Arlecchino/run-April-14-2025_10+52PM-1117294\\trainer_0_log.txt'
INFO:root:Processed y_hat: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
INFO:root:Processed x_hat: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
INFO:root:Output path: trained_models\Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets\Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'\u0361', '\u0292', 'U', 'r', '\u0279', '-', '3', '\u0283', 'J', '6', 'R', '\u025a', 'f', ' ', 'x', 'v', 'C', 'A', '?', '\u028c', '4', 'q', 'z', '0', 'V', '\u025d', 'M', 'b', '!', 'Z', '\u026b', '"', 'p', 'h', 'y', 'B', 'T', '(', 'n', 'i', 'w', '9', 'm', 'H', '\u026a', 'F', 'O', 'K', 'g', '\u025b', 'o', 'I', '1', "'", 'ð', '\u0251', '\u027e', 'j', ',', '\u014b', 'G', 'a', '.', ')', 'D', 'E', 'S', '2', '\u028a', 'l', '8', 'u', 'c', 'W', '\u0261', 'd', '7', '\u0254', '5', 'æ', ':', 'Y', 'N', 't', 'X', 'Q', 'P', 'L', 's', 'e', 'k', ';'}
INFO:root:>>> Starting Training <<<
ERROR:root:An error occurred during training.
Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1503, in train_epoch
    for cur_step, batch in enumerate(self.train_loader):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\_utils.py", line 721, in reraise
    raise RuntimeError(msg) from None
RuntimeError: Caught UnicodeEncodeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 617, in compute_or_load
    ids = np.load(cache_path)
          ^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\numpy\lib\npyio.py", line 427, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models\\Arlecchino\\phoneme_cache\\I1ZPIEFybGVjY2hpbm8gQWxseSBhdCBMb3cgSFAgMDI=_phoneme.npy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\characters.py", line 300, in char_to_id
    return self._char_to_id[char]
           ~~~~~~~~~~~~~~~~^^^^^^
KeyError: '\u0361'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 70, in encode
    idx = self.characters.char_to_id(char)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\characters.py", line 302, in char_to_id
    raise KeyError(f" [!] {repr(char)} is not in the vocabulary.") from e
KeyError: " [!] '\u0361' is not in the vocabulary."

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 273, in __getitem__
    token_ids = self.get_token_ids(idx, item["text"])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 240, in get_token_ids
    token_ids = self.get_phonemes(idx, text)["token_ids"]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 217, in get_phonemes
    out_dict = self.phoneme_dataset[idx]
               ~~~~~~~~~~~~~~~~~~~~^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 602, in __getitem__
    ids = self.compute_or_load(string2filename(item["audio_unique_name"]), item["text"], item["language"])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\datasets\dataset.py", line 619, in compute_or_load
    ids = self.tokenizer.text_to_ids(text, language=language)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 111, in text_to_ids
    text = self.encode(text)
           ^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\utils\text\tokenizer.py", line 76, in encode
    print(text)
  File "C:\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u0279' in position 6: character maps to <undefined>


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\voice_clone_train.py", line 379, in main
    trainer.fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'D:/Scripts/EchoPersona/trained_models/Arlecchino/run-April-14-2025_11+19PM-910ebb0\\trainer_0_log.txt'
INFO:root:Output path: trained_models\Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets\Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {')', 'Z', '9', 'A', 'J', 'f', 'H', 'a', 's', 'o', '\u0283', 'r', '(', 'i', 'T', '\u0254', ',', 'C', '6', 'u', 'Q', '0', '\u026a', '\u0361', '8', '\u027e', '"', '\u028c', 'c', 'V', "'", '\u025b', 'G', '4', 'B', '7', 'w', 'y', 'L', 'g', 'P', 'I', 'K', '\u025a', ';', 'j', 'k', 'X', '\u026b', 'ð', 'e', '?', '2', 'm', 'q', '\u014b', '5', 'U', ' ', 'v', 'æ', 'M', 'E', '3', 'F', 'z', '\u0279', '1', '\u028a', ':', '!', '\u0261', 'h', 'N', 'S', '.', 'W', 'O', '-', 'D', 'Y', 'b', 'd', 'p', 'R', 't', 'l', '\u0292', '\u025d', 'x', 'n', '\u0251'}
INFO:root:>>> Starting Training <<<
ERROR:root:PermissionError occurred during training.
Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1833, in fit
    self._fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1785, in _fit
    self.train_epoch()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1504, in train_epoch
    outputs, _ = self.train_step(batch, batch_num_steps, cur_step, loader_start_time)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1471, in train_step
    self.update_training_dashboard_logger(batch=batch, outputs=outputs)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\utils\distributed.py", line 35, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1971, in update_training_dashboard_logger
    self.model.train_log(
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1366, in train_log
    figures, audios = self._log(self.ap, batch, outputs, "train")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\tts\models\vits.py", line 1336, in _log
    figures = plot_results(y_hat, y, ap, name_prefix)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\TTS\vocoder\utils\generic_utils.py", line 48, in plot_results
    y_hat = y_hat[0].squeeze().detach().cpu().numpy()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Got unsupported ScalarType BFloat16

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\EchoPersona\voice_clone_train.py", line 380, in main
    trainer.fit()
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\trainer.py", line 1860, in fit
    remove_experiment_folder(self.output_path)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\trainer\generic_utils.py", line 77, in remove_experiment_folder
    fs.rm(experiment_path, recursive=True)
  File "D:\Scripts\EchoPersona\.venv\Lib\site-packages\fsspec\implementations\local.py", line 189, in rm
    shutil.rmtree(p)
  File "C:\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'D:/Scripts/EchoPersona/trained_models/Arlecchino/run-April-14-2025_11+27PM-85b6212\\trainer_0_log.txt'
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'O', '\u0261', 'æ', 'F', '6', 'r', 'u', 'i', '4', 'P', 'S', '!', 'a', '\u0251', ')', 'Q', '(', 'k', "'", 'K', 'R', ';', '\u025a', '\u028c', 'z', 'q', 'J', '\u025d', '9', 'h', ':', 'H', '7', 'Z', ',', 'U', 'p', '3', '\u026a', '"', 'E', '\u025b', 'T', 'o', '?', 'Y', '8', 'c', '5', '\u026b', '\u0254', '\u028a', '\u0283', 'e', 's', '.', 'd', 'D', '-', '\u0292', 'f', 'm', '2', 'N', 'A', '0', '\u0361', 'L', 'v', '\u014b', 'x', 'B', 'ð', 'M', 'j', 'n', 't', 'G', 'I', '\u027e', 'l', 'C', 'w', ' ', 'X', 'y', '1', 'W', '\u0279', 'V', 'b', 'g'}
INFO:root:>>> Starting Training <<<
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'n', 'H', 't', 'v', 'X', '\u025a', '1', '7', '\u0261', 'x', '3', 'D', 'S', '6', '\u028c', 'T', 'd', 'u', 'V', 'F', 'a', 'æ', 'E', 'W', '\u0361', '?', ',', '\u028a', 'z', 'p', '\u0251', '\u0292', ':', '\u014b', 'A', 'k', 'c', 'J', 'q', '"', 's', ')', '\u026b', '2', '9', '\u0254', 'i', 'ð', '\u025d', '\u0283', '4', 'B', ' ', 'g', 'K', 'h', '5', '-', ';', '(', '\u0279', 'Q', "'", 'o', 'r', 'm', '\u026a', 'C', 'b', 'O', 'R', 'P', 'U', '\u025b', 'N', 'f', 'M', '\u027e', 'y', 'I', '.', 'Y', '!', '8', '0', 'G', 'l', 'e', 'w', 'L', 'Z', 'j'}
INFO:root:Vocabulary dynamically updated successfully.
INFO:root:>>> Starting Training <<<
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'Z', 'k', 'H', '\u025d', 'o', '?', 'æ', '\u027e', 'W', 'x', '.', 'J', 'q', '\u014b', 'E', 'Q', '\u028c', ';', 'U', 's', ',', '\u0251', '\u026b', 'R', 'M', 'T', 'A', '0', 'w', '3', 'L', '8', 'n', 'S', '\u0261', 'i', 'm', 'C', 'G', '6', 'v', 'D', 'I', '7', 'ð', '"', 'X', '-', 'g', '\u025a', 'r', '!', 'j', 'O', 'f', '\u026a', 'h', 'V', '\u0292', 'z', '\u028a', 'N', '\u0283', 't', "'", '(', ')', '\u0361', '\u025b', 'y', 'l', ' ', 'a', '1', '2', ':', 'F', '4', '\u0254', 'e', '5', '\u0279', 'B', 'd', '9', 'p', 'b', 'c', 'P', 'K', 'u', 'Y'}
INFO:root:Vocabulary dynamically updated successfully.
INFO:root:Checking if character '\u0361' is in the tokenizer vocabulary...
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'p', 'F', 'K', 'u', 'T', ';', '5', 'j', 'm', '\u026a', 'f', '.', '\u026b', 'a', 'W', 'l', 'R', ',', '?', '\u025a', 'N', 'D', ':', '"', '\u028a', 'y', '0', 'P', 'M', 'b', ' ', 'g', '\u0261', 'd', '\u0254', 'Z', '-', '\u0279', 'k', 't', 'B', '\u0292', '\u0361', '\u014b', 'x', 'Y', '3', 'J', 'H', '1', 'G', '\u025b', 'æ', 'v', 'E', 'r', '(', '\u025d', 'i', '8', '\u0251', 'c', '\u0283', '7', "'", 'e', 'I', 'U', 'C', 'S', '!', 'V', 'w', '2', 'z', 'Q', '4', '6', '9', '\u027e', 'L', '\u028c', ')', 'A', 'h', 'ð', 'o', 'X', 'q', 's', 'O', 'n'}
INFO:root:Vocabulary dynamically updated successfully.
INFO:root:Checking if character '\u0361' is in the tokenizer vocabulary...
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'\u028c', '3', 'X', ')', '(', '\u0251', 'x', 'b', 'f', 'G', '\u027e', 'l', 'r', 'u', 's', 'm', 'o', 'H', 'O', '\u0254', '\u026a', 'd', '!', 'E', '-', 'g', 'N', 'C', 'B', '\u025a', '0', '7', '2', 'L', 'D', '\u0361', 'h', '\u026b', '.', 'P', '1', '"', 'R', '\u0292', ';', 'K', 'i', 'a', 'F', 'S', 'æ', 'w', '?', '\u014b', 'W', '\u025d', 'c', 'J', 't', 'z', "'", 'U', 'k', '\u0261', 'n', '\u0283', 'I', 'M', 'v', 'y', '\u028a', 'V', '5', '4', '\u025b', 'q', 'j', '9', '6', 'ð', '8', '\u0279', 'Z', 'T', ',', 'A', 'p', 'Q', ' ', 'e', 'Y', ':'}
INFO:root:Vocabulary dynamically updated successfully.
INFO:root:Checking if character '\u0361' is in the tokenizer vocabulary...
WARNING:root:tokenizer.characters is not iterable, cannot check membership.
INFO:root:Vocabulary check complete.
INFO:root:>>> Starting Training <<<
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'X', ',', '4', 'H', '\u0279', '\u028c', '\u025a', '!', 'S', 'D', 'u', 'j', 'T', 'æ', '\u028a', '\u0361', '.', ';', 'a', 'p', 'I', 'U', 'v', 'Y', 'k', 'L', 'r', 't', 'Z', '\u014b', 'V', 'o', '(', '\u025d', 'd', '0', 'y', '?', 'c', 'J', "'", 'n', 'N', '3', '\u026b', 'E', ')', '\u0251', 'g', 'R', '1', '\u025b', 'K', '9', 'w', '2', '6', 'b', '"', '\u026a', 'x', 'f', 'Q', '\u0261', 'W', '7', ':', 'P', '5', 'A', 'm', '8', ' ', 'M', 'e', 's', 'C', 'z', 'ð', '\u027e', '\u0254', 'h', 'O', 'i', 'B', 'q', '\u0292', '-', 'G', 'F', '\u0283', 'l'}
INFO:root:Vocabulary dynamically updated successfully.
INFO:root:Checking if character '\u0361' is in the tokenizer vocabulary...
WARNING:root:tokenizer.characters is not iterable, cannot check membership.
INFO:root:Vocabulary check complete.
INFO:root:>>> Starting Training <<<
INFO:root:Output path: trained_models/Arlecchino
INFO:root:AudioProcessor initialized successfully.
INFO:root:Loading dataset samples from: voice_datasets/Arlecchino
INFO:root:Loaded 199 training samples.
INFO:root:Loaded 2 evaluation samples.
INFO:root:VITS model initialized successfully.
INFO:root:Trainer initialized successfully.
INFO:root:Vocabulary updated successfully.
INFO:root:Updated vocabulary with comprehensive characters: {'a', '1', ',', '\u027e', '5', 'i', 'x', 'r', '\u028c', '\u0254', '\u0283', 'J', 'h', '\u026b', 'æ', 'u', '\u025b', 'p', 'T', 'c', '0', 'j', '3', ';', 'Q', '!', 'n', ':', 'V', '6', '7', 'R', 'b', 'K', 'Y', 'D', '.', 'm', '\u0279', 'Z', '\u0292', 's', 'w', 'M', 'e', '\u028a', '\u0251', '"', 'l', 'd', 'L', 'F', '-', '\u025d', 'O', ' ', 'C', 'I', '4', 'k', '9', '\u0261', 'y', '\u014b', 'U', 'P', '\u026a', 'B', 'E', 'ð', '8', 't', 'H', 'N', 'q', '(', 'G', 'W', 'o', 'S', 'A', '2', 'v', ')', '?', '\u0361', "'", 'X', 'f', 'z', '\u025a', 'g'}
INFO:root:Vocabulary dynamically updated successfully.
WARNING:root:Tokenizer does not support dynamic vocabulary updates.
INFO:root:Checking if character '\u0361' is in the tokenizer vocabulary...
WARNING:root:Tokenizer does not support dynamic vocabulary updates.
INFO:root:Vocabulary check complete.
INFO:root:>>> Starting Training <<<
